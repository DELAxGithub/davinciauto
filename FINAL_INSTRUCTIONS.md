# 🎬 最終版 - DaVinci Resolve マーカー生成システム

## 📁 使用するファイル

**Google Apps Script**: `gas_final_complete.js`
**DaVinci Console**: `davinci_console_marker.py`

## 🚀 Google Apps Script 設定手順

### 1. スクリプト設定
1. Google Sheets を開く
2. `拡張機能` → `Apps Script` を選択
3. `gas_final_complete.js` の内容をコピー＆ペースト
4. 保存（Ctrl+S）

### 2. 実行準備
1. 一度 `onOpen` 関数を手動実行（初回のみ）
2. 権限許可のダイアログが出たら許可
3. スプレッドシートを再読み込み
4. メニューバーに「🎬 DaVinci マーカー生成」が表示される

## 📋 使用手順

### Step 1: データ解析・整形
```
元データ: [00:01:30:05 - 00:01:45:10]
         重要な発言です
         [00:01:45:10 - 00:02:00:15] 
         さらに続きます
```
↓
```
A列: 00:01:30:05 | B列: 00:01:45:10 | C列: 重要な発言です
A列: 00:01:45:10 | B列: 00:02:00:15 | C列: さらに続きます
```

**実行**: メニュー → `📝 Step 1: データ解析・整形`

### Step 2: 色分け選択
```
A列: 00:01:30:05 | B列: 00:01:45:10 | C列: 重要な発言です | D列: [プルダウン]
```

**色の意味**:
- `rose` - 重要内容（カット不可）
- `mint` - 料理・園芸話題
- `cyan` - オープニング・番組紹介
- `lemon` - CM・広告
- `lavender` - 対談・討論
- `sky` - まとめ・天気
- `sand` - その他
- `cream` - 一般
- **空白** - 使わない（マーカーなし）

**実行**: メニュー → `🎨 Step 2: 色分け選択`

### Step 3: マーカーCSV生成
同一色の連続する行を1つのデュレーションマーカーに統合

```
例: rose → rose → rose (3行連続)
→ 1個のデュレーションマーカー（最初〜最後の時間）
```

**実行**: メニュー → `🎯 Step 3: マーカーCSV生成`

## 🎯 DaVinci Resolve での使用

### 1. CSV データ準備
1. 「DaVinci区間マーカー」シートが作成される
2. データを全選択してコピー
3. CSVファイルとして保存（例: `my_markers.csv`）

### 2. DaVinci での実行
1. DaVinci Resolve でプロジェクト・タイムラインを開く
2. `ワークスペース` → `コンソール` を開く
3. `davinci_console_marker.py` の内容を貼り付け
4. 実行: `run_csv("my_markers.csv")`

### 3. 結果確認
- タイムラインにデュレーションマーカーが自動配置
- 色分けされたマーカーでセグメント識別
- 各マーカーに文字起こし内容とキーワードが格納

## 📊 追加機能

### メニュー機能
- `📊 データ統計表示` - 現在の色選択状況を確認
- `🔧 全データリセット` - 全データをクリアして最初からやり直し

### 自動処理
- カスタムメニューの自動生成
- 色選択の背景色自動変更
- エラーハンドリングとユーザー通知

## ⚠️ 注意事項

1. **順番通りに実行** - Step 1 → 2 → 3 の順番必須
2. **色選択が重要** - Step 2 で色を選ばない行はマーカー生成されない
3. **同一色区間** - 連続する同色行が1つのデュレーションマーカーになる
4. **DaVinciコンソール** - Pythonスクリプトは内蔵コンソールで実行

## 🎉 完了！

このシステムで手動マーカー配置作業を90%削減し、ラジオ番組編集ワークフローを大幅に効率化できます。