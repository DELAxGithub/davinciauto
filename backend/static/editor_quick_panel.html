<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Editor Quick Panel</title>
  <style>
    body{font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin:24px;}
    .row{display:flex; gap:8px; align-items:center;}
    .col{display:flex; gap:12px; flex-direction:column;}
    .card{border:1px solid #ddd; border-radius:8px; padding:12px;}
    input[type=text]{width:420px; padding:6px 8px;}
    button{padding:8px 12px; cursor:pointer;}
    .muted{color:#666;}
  </style>
  <script>
    async function post(url, body){
      const res = await fetch(url, { method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify(body) });
      return res.json();
    }
    async function saveProject(){
      const dir = document.querySelector('#proj').value.trim();
      if(!dir) return alert('プロジェクトパスを入力');
      const sample = { name: 'project', savedAt: new Date().toISOString(), data: [] };
      const j = await post('/api/projects/save', { project_dir: dir, project: sample, filename: 'project.json' });
      if(j&&j.ok) alert('保存: '+j.path); else alert('保存エラー: '+JSON.stringify(j));
    }
    async function exportSrt(){
      const dir = document.querySelector('#proj').value.trim();
      if(!dir) return alert('プロジェクトパスを入力');
      // minimal SRT with no rows (placeholder)
      const name = (document.querySelector('#name').value||'project').trim();
      const filename = `テロップ類/SRT/${name}_Sub_follow.srt`;
      const j = await post('/api/srt/export_to_file', { rows: [], source:'follow', offset_ms:0, project_dir: dir, filename });
      if(j&&j.ok) alert('SRT: '+j.path); else alert('SRTエラー: '+JSON.stringify(j));
    }
  </script>
</head>
<body>
  <h2>編集向けクイックパネル</h2>
  <div class="card col">
    <div class="row">
      <label>プロジェクトパス: <input id="proj" type="text" placeholder="/abs/path/to/OrionEp1"></label>
      <label>プロジェクト名: <input id="name" type="text" placeholder="OrionEp1" style="width:200px"></label>
    </div>
    <div class="row">
      <button onclick="saveProject()">project.json 保存</button>
      <button onclick="exportSrt()">SRT 保存（テロップ類/SRT）</button>
      <a href="/" target="_blank"><button>LLMワークスペースを開く</button></a>
    </div>
    <div class="muted">詳細操作は LLM ワークスペースで行えます（行編集、ナレーション、BGM/SE 生成など）。</div>
  </div>
</body>
</html>
